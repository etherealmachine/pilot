<link rel="import" href="/static/components/index.html">
<link rel="import" href="/static/components/play.html">
<link rel="import" href="/static/components/tv.html">
<dom-module id="pilot-main">

  <script src="/static/deps/page.js"></script>

  <template>
    <template is="dom-if" if="{{curr(page, 'index')}}">
      <pilot-index></pilot-index>
    </template>
    <template is="dom-if" if="{{curr(page, 'play')}}">
    <pilot-play video="{{page.params.video}}"></pilot-play>
    </template>
    <template is="dom-if" if="{{curr(page, 'tv')}}">
      <pilot-tv video="{{page.params.video}}">></pilot-tv>
    </template>
  </template>

  <script>
    Polymer({
      is: 'pilot-main',
      ready: function() {
        this.page = null;
        page('/', this.index.bind(this));
        page('/play/:video(.*)', this.play.bind(this));
        page('/tv/:video(.*)', this.tv.bind(this));
        page.base('/#!');
        page();
      },
      index: function(ctx, next) {
        this.set('page', {
          name: 'index'
        });
      },
      play: function(ctx, next) {
        this.set('page', {
          name: 'play',
          params: {
            video: ctx.params.video
          }
        });
      },
      tv: function(ctx, next) {
        this.set('page', {
          name: 'tv',
          params: {
            video: ctx.params.video
          }
        });
      },
      curr: function(page, name) {
        return page && page.name == name;
      }
    });
  </script>

</dom-module>