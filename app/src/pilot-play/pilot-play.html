<link rel="import" href="/bower_components/polymer/polymer.html">

<!-- Iron -->
<link rel="import" href="/bower_components/iron-flex-layout/iron-flex-layout-classes.html">

<dom-module id="pilot-play">
  <template>
    <style>
      :host {
        display: block;
        @apply(--layout-vertical);
      }
      video {
        @apply(--layout-center-justified);
      }
    </style>

    <video
        id="video"
        controls
        autoplay>
    </video>
  </template>

  <script>
    Polymer({

      is: 'pilot-play',

      properties: {
        file: {
          type: String,
          observer: '_fileChanged'
        },
        selected: Boolean
      },

      ready: function() {
        this.parentNode.addEventListener("iron-select", this._ironSelect.bind(this));
      },

      _ironSelect: function(event) {
        this.selected = event.detail.item == this;
        if (!this.selected) {
          this.$.video.src = '';
        } else if (this.file) {
          this.$.video.src = '/download?file='+this.file;
        }
      },

      _fileChanged: function() {
        if (this.selected) {
          this.$.video.src = '/download?file='+this.file;
        }
      }

    });
  </script>
</dom-module>